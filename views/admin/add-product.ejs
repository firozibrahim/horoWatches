<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link rel="stylesheet" href="/admin/css/dashboard.css" />
  <title>products</title>
  <style>
    /* Style the main product image container */
    .product-image {
      width: 200px;
      height: 200px;
      padding: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #ccc;
      cursor: pointer;
      overflow: hidden;
    }

    /* Style the image preview for the main product image */
    #imagePreview1 {
      max-width: 100%;
      max-height: 100%;
    }

    /* Style the child image container */
    #childMain {
      display: flex;
      margin-top: 10px;
    }

    /* Style each child image section */
    .image-list li {
      width: 100px;
      height: 100px;
      margin-right: 10px;
      /* Add some spacing between child image sections */
    }

    /* Style the child image labels */
    .preview-container {
      width: 100px;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #ccc;
      cursor: pointer;
    }

    /* Style the child image previews */
    .image-preview {
      max-width: 100%;
      max-height: 100%;
    }

    /* Hide the default file input styles */
    .input-hidden {
      display: none;
    }
  </style>
</head>

<body>
  <div class="d-flex" id="wrapper">
    <%-include("../partials/admin/sidebar.ejs")%>

      <!-- /#page-content-wrapper -->
      <div class="container">
        <form action="/admin/addproduct" method="post" id="form" enctype="multipart/form-data" class="bg-gradient">
          <div class="d-flex">
            <div style="height: 650px;">
              <div class="column-xs-12 column-mD-5 d-flex m-3">
                <div class="product-gallery d-flex">
                  <label class="product-image "
                    style="width: 600px; height: 600px; padding-bottom: 5px; display: flex; align-items: center; justify-content: center; overflow: hidden;;">
                    <input type="file" id="productImage1" accept="image/*" class="input-hidden"
                      onchange="previewImage(this,event, 'imagePreview1')" name="productMainImage" multiple required>
                    <img id="imagePreview1" class="image-preview" style="width: 100%;height:auto;">
                  </label>
                  <div class="d-block flex-row" style="height:600px; width:200px">
                    <label class="product-image"
                      style="width: 200px; height: 200px; padding-bottom: 5px; display: flex;">
                      <!-- <input type="file" id="productImage1" accept="image/*" class="input-hidden" onchange="previewImage(this,event, 'imagePreview2')" name="productMainImage"> -->
                      <img id="imagePreview2" class="image-preview">
                    </label>
                    <label class="product-image"
                      style="width: 200px; height: 200px; padding-bottom: 5px; display: flex;">
                      <!-- <input type="file" id="productImage1" accept="image/*" class="input-hidden" onchange="previewImage(this,event, 'imagePreview3')" name="productMainImage"> -->
                      <img id="imagePreview3" class="image-preview">
                    </label>
                    <label class="product-image"
                      style="width: 200px; height:200px; padding-bottom: 5px; display: flex;">
                      <!-- <input type="file" id="productImage1" accept="image/*" class="input-hidden" onchange="previewImage(this,event, 'imagePreview4')" name="productMainImage"> -->
                      <img id="imagePreview4" class="image-preview">
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div style="width: 50vw;">
              <div class="form-group m-3">
                <label for="productName">Product Name : </label>
                <input type="text" name="ProductName" class="form-control bg-light" id="productName"
                  placeholder="Product name"/>
                <div class="error" id="productNameError"></div>
              </div><br>

              <div class="form-group m-3">
                <label for="productDescription">Product Description:</label>
                <textarea class="form-control bg-light" name="Description" id="productDescription" rows="4"
                  placeholder="Enter product description"></textarea>
                <div class="error" id="description-error"></div>
                
              </div>
              <br>
              <div class="form-group m-3">
                <label for="productSpecification">Product Specification:</label>
                <textarea class="form-control bg-light" name="Specification1" id="productSpecification1"
                placeholder="Enter product Specification"></textarea>
                <div class="error" id="specificationError1"></div>
                <label for="productSpecification2">Product Specification:</label>
                <textarea class="form-control bg-light" name="Specification2" id="productSpecification2"
                placeholder="Enter product Specification"></textarea>
                <div class="error" id="specificationError2"></div>
                <label for="productSpecification3">Product Specification:</label>
                <textarea class="form-control bg-light" name="Specification3" id="productSpecification3"
                placeholder="Enter product Specification"></textarea>
                <div class="error" id="specificationError3"></div>
              </div>
              <br>
            </div>
          </div>
          <div class="d-flex">
            <div style="width:50rem">
              
              <div class="border p-3 m-3">
                <h2>Pricing</h2>
                <div class="form-group">
                  <label for="basePrice">Base Price:</label>
                  <input type="number" name="Price" class="form-control bg-light" id="basePrice"
                  placeholder="Enter base price"/>
                  <div class="error" id="priceerror"></div>
                </div>
                <br>
                <div class="form-group">
                  <label for="discountAmount">Discount Amount:</label>
                  <input type="number" name="DiscountAmount" class="form-control bg-light" id="discountAmount"
                  placeholder="Enter discount amount"/>
                  <div class="error" id="discError"></div>
                </div>
              </div>
              <div class="border p-3 m-3">
                <h2>Stock</h2>
                <div class="form-group">
                  <label for="quantity">Quantity:</label>
                  <input type="number" name="AvailableQuantity" class="form-control bg-light" id="quantity"
                  placeholder="Enter quantity"/>
                  <div class="error" id="quantityError"></div>
                </div>
              </div>
            </div>
            <div class="border p-3 m-3" style="width:50rem;">
              <div class="">
                <div class="form-group">
                  <br>
                  <label>Category:</label>
                  <select class="form-select bg-light" id="category" name="Category" required>
                    <option value="" selected disabled>Select a category</option>
                    <% category.forEach(categoryItem=> { %>
                      <option>
                        <%= categoryItem.CategoryName %>
                      </option>
                      <% }); %>
                  </select>
                </div><br>
                <div class="form-group">
                  <br>
                  <label>Brand Name:</label>
                  <select name="BrandName" class="form-select bg-light" id="brand" required>
                    <option value="" selected disabled>Select a Brand</option>
                    <option>ROLEX</option>
                    <option>OMEGA</option>
                    <option>PANERAI</option>
                    <option>TAG HEUER</option>
                  </select>
                </div><br>
                <div class="form-group">  
                  <label for="tags">Tags:</label>
                  <input type="text" class="form-control bg-light" name="Tags" id="tags" placeholder="Enter tags"/>
                </div>
              </div>
              <div class="d-flex justify-content-end mt-4">
                <button type="submit" class="btn btn-primary">Add Product</button>
              </div>
            </div>
          </div>

        </form>
      </div>
    </main>
    </div>
    </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    
    var el = document.getElementById("wrapper");
    var toggleButton = document.getElementById("menu-toggle");

    toggleButton.onclick = function () {
      el.classList.toggle("toggled");
    };
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('form');
        const productInput = document.getElementById('productName');
        const productDescription = document.getElementById('productDescription');
        const productSpecificationinput1 = document.getElementById('productSpecification1');
        const productSpecificationinput2 = document.getElementById('productSpecification2');
        const productSpecificationinput3 = document.getElementById('productSpecification3');
        const basepriceInput = document.getElementById('basePrice');
        const discAmountInput = document.getElementById('discountAmount');
        const quantityInput = document.getElementById('quantity');
        const nameError = document.getElementById('productNameError');
        const descriptionError = document.getElementById('description-error');
        const specierror1 = document.getElementById('specificationError1');
        const specierror2 = document.getElementById('specificationError2');
        const specierror3 = document.getElementById('specificationError3');
        const priceerror = document.getElementById('priceerror');
    const quantityError = document.getElementById('quantityError');
    const discError = document.getElementById('discError');
        form.addEventListener("submit", function (event) {

          //resetting previous error message
          nameError.innerHTML = "";
          descriptionError.innerHTML = "";
          specierror1.innerHTML = "";
          specierror2.innerHTML = "";
          specierror3.innerHTML = "";
          priceerror.innerHTML = "";
          quantityError.innerHTML= "";
          discError.innerHTML= "";
          //validate emailInput
          const nameValue = productInput.value.trim()
          const descriptionValue = productDescription.value.trim();
          const speciValue1 = productSpecificationinput1.value.trim()
          const speciValue2 = productSpecificationinput2.value.trim()
          const speciValue3 = productSpecificationinput3.value.trim()
          if (nameValue === "") {
            event.preventDefault(); 
            nameError.innerHTML = "product name can't be empty"
            return
          }
          if (descriptionValue === "") {
            event.preventDefault(); 
            descriptionError.innerHTML = "Please fill out description"
            return
          }
          //validate password input

          if (speciValue1 === "") {
            event.preventDefault(); 
            specierror1.innerHTML = "Confirm Password field can't be empty";
            return
            
          }
          if (speciValue2 === "") {
            event.preventDefault(); 
            specierror2.innerHTML = "Confirm Password field can't be empty";
            return
            
          }
          if (speciValue3 === "") {
            event.preventDefault(); 
            specierror3.innerHTML = "Confirm Password field can't be empty";
            return
            
          }
          if (isNaN(parseFloat(basepriceInput.value)) || parseFloat(basepriceInput.value) <= 0) {
            event.preventDefault()
          priceerror.innerHTML = "Price must be a positive number.";
          return

        }

        if (isNaN(parseInt(quantityInput.value)) || parseInt(quantityInput.value) < 0) {
          event.preventDefault()
          quantityError.innerHTML = "stock must be a non-negative integer.";
          return;
        }
        if (isNaN(parseInt(discAmountInput.value)) || parseInt(discAmountInput.value) < 0) {
          event.preventDefault()
          discError.innerHTML = "amount must be a non-negative integer.";
          return;
        }
        if(discAmountInput.value>basepriceInput.value){
            event.preventDefault()
          priceerror.innerHTML = "Price must be greater than discounted amount.";
          return

        }
        const productImageInput = document.getElementById('productImage1');
         if (productImageInput.files.length > 4) {
        event.preventDefault();
        alert('You should select only four images.');
        return;
    }
        })
      })

  </script>

  <!-------validation------>
  <script src="/admin/js/script.js"></script>
</body>

</html>