<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>loginpage</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="user/css/home.css">
</head>

<body>
  <%-include("../partials/unAuthorisedNavbar.ejs")%>
    <div class="login"> 
      <div class="input">
        <div id="error-message" class="error"></div>
        <form action="/admin/login" method="post" class="form1" id="loginForm">
          <div class="header_text">
            <h2>admin signIn/h2>
            <p>Enter your detail below</p>
          </div>
          <div class="inp_l">
            <input class="login-input" type="text" id="emailInput" name="emailInput" autofocus
              placeholder="enter your Email Address">
            <div class="error-message" id="emailError"></div>
            <input class="login-input" type="password" id="password" name="password" placeholder="password">
            <div class="error-message" id="passwordError"></div>
          </div>
          <div class="final">
            <div class="last">
              <button class="login-button" type="submit">
                login
              </button>
        </form>
      </div>

    </div>
    </div>
    <div class="img-login"></div>

    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const loginForm = document.getElementById('loginForm');
        const emailInput = document.getElementById('emailInput');
        const passwordInput = document.getElementById('password');
        const emailError = document.getElementById('emailError');
        const passwordError = document.getElementById('passwordError');
        loginForm.addEventListener("submit", function (event) {
          event.preventDefault()
          //resetting previous error message
          emailError.innerHTML = "";
          passwordError, innerHTML = "";
          //validate emailInput
          const emailValue = emailInput.value.trim()
          if (emailValue === "") {
            emailError.innerHTML = "Email address can't be empty"
            return;
          }
          //validate password input
          const passwordValue = passwordInput.value.trim()
          if (passwordValue === "") {
            passwordValue.innerHTML = "password field can't be empty"
            return;
          }
          fetch('user/login', {
            method: 'POST',
            body: JSON.stringify({ email: emailValue, password: passwordValue }),
            headers: {
              'Content-Type': 'application/json',
            },
          })
            .then(response => response.json())
            .then(data => {
              if (data.success) {
                window.location.href = "/user/home";
              } else {
                document.getElementById("error-message").textContent = data.error;
              }
            })
            .catch(error => {

              console.log(error)
            })


        })
      });
    </script>
</body>

</html>